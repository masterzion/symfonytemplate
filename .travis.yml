language: php
php:
  - "5.5"
  - hhvm

install:
   - composer selfupdate
   - composer --profile --prefer-source --no-interaction install

# Acceptance tests
before_script:
  - sudo apt-get install nginx
  - sudo cp -f ./travis/nginx/nginx.conf /etc/nginx/nginx.conf
  - sudo cp -f ./travis/nginx/travis.vhost /etc/nginx/sites-available/default
  - LOCALDIR="$(pwd)/public"
  - sudo sed -i "s#LOCAL_DIR#${LOCALDIR}#" /etc/nginx/sites-available/default
  # php5 fpm
  - if [[ $TRAVIS_PHP_VERSION =~ ^hhvm ]]; cp ~/.phpenv/versions/$(phpenv version-name)/etc/php-fpm.conf.default ~/.phpenv/versions/$(phpenv version-name)/etc/php-fpm.conf
  - if [[ $TRAVIS_PHP_VERSION =~ ^hhvm ]]; ~/.phpenv/versions/$(phpenv version-name)/sbin/php-fpm
  - if [[ $TRAVIS_PHP_VERSION =~ ^hhvm ]]; sudo service nginx restart
  - pear install PHP_CodeSniffer
  - phpenv rehash

script:
  - phpcs src
  - cd app
  - phpunit

after_script:


notifications:
  email: "master.zion@gmail.com"
